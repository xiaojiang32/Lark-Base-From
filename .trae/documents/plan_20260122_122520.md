# å®ç°æ•°æ®æäº¤é…ç½®åŠŸèƒ½

## ğŸ“‹ å®ç°ç›®æ ‡

åœ¨è¡¨å•é…ç½®é¢æ¿ä¸­æ–°å¢"æ•°æ®æäº¤"é…ç½®é¡¹ï¼Œæ”¯æŒé…ç½® HTTP è¯·æ±‚å‚æ•°ï¼Œç‚¹å‡»æäº¤æŒ‰é’®æ—¶å‘èµ·è¯·æ±‚ã€‚

## ğŸ¯ å®ç°æ­¥éª¤

### 1. æ›´æ–°ç±»å‹å®šä¹‰ï¼ˆtypes.tsï¼‰

æ·»åŠ æ•°æ®æäº¤ç›¸å…³æ¥å£ï¼š

```typescript
export interface ISubmitConfig {
  enabled: boolean;
  method: 'GET' | 'POST';
  url: string;
  params: Array<{ key: string; value: string }>;
  headers: Array<{ key: string; value: string }>;
  successStatusRange: { min: number; max: number };
}

export interface IFormConfig {
  // ... ç°æœ‰å­—æ®µ
  submitConfig?: ISubmitConfig;
}
```

### 2. åˆ›å»ºæ•°æ®æäº¤é…ç½®é¢æ¿ç»„ä»¶

åˆ›å»º `src/components/Form/config/SubmitConfigPanel/index.tsx`ï¼š

é…ç½®é¡¹åŒ…æ‹¬ï¼š
- å¯ç”¨æ•°æ®æäº¤ï¼ˆSwitchï¼‰
- è¯·æ±‚æ–¹æ³•ï¼ˆSelect: GET/POSTï¼‰
- è¯·æ±‚ URLï¼ˆInputï¼‰
- è¯·æ±‚å‚æ•° Paramsï¼ˆåŠ¨æ€é”®å€¼å¯¹åˆ—è¡¨ï¼‰
- è¯·æ±‚å¤´ Headersï¼ˆåŠ¨æ€é”®å€¼å¯¹åˆ—è¡¨ï¼‰
- æˆåŠŸçŠ¶æ€ç èŒƒå›´ï¼ˆInputNumber: min-maxï¼‰

### 3. æ›´æ–° GlobalConfigPanel

åœ¨ `src/components/Form/index.tsx` çš„ GlobalConfigPanel ä¸­æ·»åŠ æ–°çš„é…ç½®ç»„ï¼š

```tsx
<div className="config-group">
  <div className="config-group-title">æ•°æ®æäº¤</div>
  <SubmitConfigPanel 
    config={config.submitConfig} 
    setConfig={setConfig} 
  />
</div>
```

### 4. å®ç°æ•°æ®æäº¤é€»è¾‘

åœ¨ `src/hooks.ts` çš„ submitForm å‡½æ•°ä¸­æ·»åŠ  HTTP è¯·æ±‚é€»è¾‘ï¼š

```typescript
if (config.submitConfig?.enabled) {
  const response = await fetch(config.submitConfig.url, {
    method: config.submitConfig.method,
    headers: buildHeaders(config.submitConfig.headers),
    body: buildBody(formData, config.submitConfig.method)
  });
  
  const isSuccess = checkStatus(response.status, config.submitConfig.successStatusRange);
  // ... å¤„ç†å“åº”
}
```

### 5. å®ç°è¯·æ±‚ä½“æ•°æ®æ˜ å°„

åˆ›å»ºå·¥å…·å‡½æ•°ï¼Œå°†è¡¨å•æ•°æ®æ˜ å°„ä¸ºè¯·æ±‚ä½“æ ¼å¼ï¼š

```typescript
// æ–‡æœ¬ç»„ä»¶ï¼š{"ç»„ä»¶ID": "å€¼"}
// é€‰é¡¹ç»„ä»¶ï¼š{"ç»„ä»¶ID": ["é€‰é¡¹1", "é€‰é¡¹2"]}
const buildRequestBody = (formData: Record<string, any>, fields: IFormField[]) => {
  return fields.reduce((body, field) => {
    const value = formData[field.id];
    if (field.type === 'option' && Array.isArray(value)) {
      body[field.id] = value;
    } else {
      body[field.id] = value;
    }
    return body;
  }, {} as Record<string, any>);
};
```

### 6. æ›´æ–°é»˜è®¤é…ç½®

åœ¨ `src/utils.ts` çš„ getDefaultFormConfig ä¸­æ·»åŠ é»˜è®¤çš„ submitConfigï¼š

```typescript
submitConfig: {
  enabled: false,
  method: 'POST',
  url: '',
  params: [],
  headers: [],
  successStatusRange: { min: 200, max: 299 }
}
```

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- æ”¯æŒåŠ¨æ€æ·»åŠ /åˆ é™¤ Params å’Œ Headers
- è¯·æ±‚ä½“è‡ªåŠ¨æ˜ å°„è¡¨å•æ•°æ®ï¼ˆåªè¯»é¢„è§ˆï¼‰
- æˆåŠŸçŠ¶æ€ç èŒƒå›´å¯é…ç½®
- æ”¯æŒé”™è¯¯æç¤ºå’ŒåŠ è½½çŠ¶æ€
- å®Œæ•´çš„ TypeScript ç±»å‹æ”¯æŒ

